# PRD v1 — 천지연꽃신당 온라인 신점 서비스

작성일: 2026-02-14  
버전: v1.0 (초안)

---

## 1. 제품 개요

### 1.1 제품명(가칭)
- **천지연꽃신당 — 온라인 신점 상담 플랫폼**

### 1.2 목표
- 오프라인 신점 상담을 웹/앱으로 확장
- 1시간 단위 예약형 화상/음성 상담 제공
- 캐시 기반 결제로 사용성/정산 단순화

### 1.3 타겟 사용자
- 신점 상담을 온라인으로 받고 싶은 일반 고객
- 상담을 제공하는 무당(상담사)
- 운영 관리자(CS/정산/분쟁 처리)

---

## 2. 핵심 문제 & 해결

### 2.1 문제
- 상담 예약/결제/통화가 분절됨(전화/계좌이체/메신저 혼재)
- 노쇼/취소/분쟁 규칙이 불명확
- 상담 기록 및 정산 추적 어려움

### 2.2 해결
- 회원가입 → 상담사 선택 → 예약 → 캐시 결제 → 통화 → 후기까지 단일 플로우
- 정책 기반 환불/취소 규칙 자동화
- 관리자 콘솔에서 상담/결제/정산 통합 관리

---

## 3. 범위 정의

### 3.1 MVP In-Scope
1. 회원가입/로그인
2. 상담사 탐색/상세/예약
3. 1시간 슬롯 예약
4. 캐시 상품 결제 (PortOne + KG이니시스)
5. Sendbird 화상/음성 상담
6. 상담 종료 처리 및 이력
7. 후기 작성
8. 기본 관리자 기능(회원/상담/결제 조회, 환불 처리)

### 3.2 Out-of-Scope (v1 제외)
- AI 운세 생성
- 다국어 지원
- 실시간 다자 통화
- 정교한 추천 알고리즘(초기엔 단순 정렬)

---

## 4. 플랫폼/기술 스택

- Web: Next.js (React)
- App: Flutter
- Backend: Spring Boot 3.5, Java 21
- DB: MySQL (주데이터), Redis (세션/락/타이머/캐시)
- 결제: PortOne + KG이니시스
- 통화: Sendbird Calls (영상/음성)

---

## 5. 사용자 메뉴 구조 (웹)

1. 홈
2. 상담 찾기
3. 예약/일정
4. 상담실
5. 캐시충전/결제
6. 상담내역
7. 고객센터
8. 마이페이지

---

## 6. 핵심 사용자 플로우

### 6.1 예약형 상담 플로우
1) 회원가입/로그인  
2) 상담사 선택  
3) 시간 슬롯(1시간) 선택  
4) 캐시 부족 시 충전 유도  
5) 예약 확정  
6) 상담 시작 시간 도달 시 입장  
7) 60분 통화 진행  
8) 자동 종료/수동 종료  
9) 후기 작성

### 6.2 결제/캐시 플로우
1) 캐시 상품 선택  
2) PortOne 결제 요청  
3) KG이니시스 결제 완료  
4) 웹훅 검증  
5) 캐시 지갑 적립  
6) 트랜잭션 로그 저장

---

## 7. 도메인 모델 (초안)

- User
- Counselor
- CounselorScheduleSlot
- Reservation
- ConsultationSession
- Wallet
- CashTransaction
- Payment
- Refund
- Review
- Dispute
- Notification

---

## 8. 정책(초안)

### 8.1 시간 정책
- 모든 상담은 **60분 고정**
- 시작 10분 전부터 입장 가능
- 서버 기준 시간으로 종료 판단

### 8.2 취소/환불 정책(초안)
- 상담 시작 24시간 전: 100% 환불
- 24시간 이내 ~ 1시간 전: 50% 환불
- 1시간 이내/노쇼: 환불 불가(운영자 예외 처리 가능)

### 8.3 캐시 차감 정책
- 예약 시 선차감(hold)
- 상담 시작 시 확정 차감
- 미시작/시스템장애 시 자동 환급

---

## 9. 기능 요구사항 (MVP)

### 9.1 회원
- 이메일/소셜 로그인(최소 1종)
- 프로필 수정
- 약관 동의 이력 보관

### 9.2 상담사
- 상담사 리스트/상세
- 전문분야, 소개, 평점, 후기
- 가능 시간대 설정

### 9.3 예약
- 슬롯 조회/예약/취소/변경
- 중복 예약 방지(분산락)

### 9.4 통화
- Sendbird 세션 발급
- 입장/종료 이벤트 로그 저장
- 네트워크 이슈 재접속 허용 정책

### 9.5 결제
- 결제 요청 생성
- 결제 성공/실패 처리
- 웹훅 idempotency
- 영수증/결제내역 조회

### 9.6 관리자
- 상담/결제/환불 조회
- 분쟁 티켓 처리
- 상담사 상태 관리

---

## 10. 비기능 요구사항

- 보안: PII 암호화, 민감정보 최소 수집
- 성능: 예약/결제 API p95 < 500ms(내부 기준)
- 가용성: 장애 시 예약/결제 데이터 정합성 보장
- 감사로그: 결제/환불/권한변경 필수 로깅

---

## 11. 리스크 Top 10 (초안)

1. 결제 웹훅 중복 수신으로 중복 캐시 적립
2. 슬롯 동시 예약 충돌
3. 통화 중 끊김에 따른 환불 분쟁
4. 노쇼/지각 정책 불명확
5. 상담 내용 저장 범위에 대한 개인정보 리스크
6. 관리자 오조작(수동 환불/차감)
7. 상담사 품질 편차
8. 피크 시간대 예약 몰림
9. 악성 후기/신고 처리 지연
10. 규정/약관 미정비로 인한 CS 폭증

---

## 12. 8주 실행 로드맵 (초안)

### Week 1-2
- IA/디자인 가이드
- 회원/권한/기본 도메인 구축
- 상담사/스케줄/예약 모델 구현

### Week 3-4
- 결제/캐시/웹훅/환불 정책 구현
- 예약 확정/취소 로직 안정화

### Week 5-6
- Sendbird 통화 연동
- 타이머/입장/종료 이벤트 저장
- 상담내역/후기

### Week 7
- 관리자 콘솔(조회/환불/분쟁)
- 모니터링/로그/알림

### Week 8
- 통합 QA/UAT
- 정책 최종 확정
- 운영 배포

---

## 13. 성공지표 (MVP)

- 예약 완료율
- 결제 성공률
- 상담 시작률(예약 대비)
- 상담 완료율
- 환불/분쟁 비율
- 재구매율(30일)

---

## 14. 다음 액션

1. PRD v1 리뷰(사업/운영/개발)
2. 환불/노쇼 정책 문구 확정
3. MVP 화면 목록 확정 (웹/앱)
4. API/ERD v1 상세화
5. Sprint 1 백로그 작성
